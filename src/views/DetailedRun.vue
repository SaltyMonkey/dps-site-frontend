<template>
	<v-container fluid class="pt-1">
		<IndeterminatedTopProgressBar
			v-if="loadingData"
		></IndeterminatedTopProgressBar>
		<v-row v-if="!loadingData" dense align="start" justify="center">
			<v-col cols="12" sm="5" md="4" lg="2" xl="2">
				<SimpleMultilineCard
					title="Encounter:"
					:firstLine="dungeonName"
					:secondLine="bossName"
				></SimpleMultilineCard>
				<SimpleDateTimeTextCard
					title="Date:"
					:firstLine="getFormattedHours"
					:secondLine="getFormattedDate"
					:timeLine="runData.timestamp"
				></SimpleDateTimeTextCard>
				<RegisteredDamageCard></RegisteredDamageCard>
				<BossEnrageCard :uptime="enrageData"></BossEnrageCard>
				<BossDebuffsCard
					:abnormalsData="abnormalsData"
					:debuffDetail="runData.debuffDetail"
				></BossDebuffsCard>
			</v-col>
			<v-col cols="12" sm="7" md="8" lg="8" xl="7">
				<div class="scroller-cutted" :class="currentTheme">
					<v-row no-gutters justify="center">
						<SimpleOneLineCard
							title="Duration:"
							:line="formatStringAsTimeSpan(runData.fightDuration)"
						></SimpleOneLineCard>
						<SimpleOneLineCard
							title="Party dps:"
							:line="formatStringAsDps(runData.partyDps)"
						></SimpleOneLineCard>
						<SimpleOneLineCard
							title="Average dps:"
							:line="formatStringAsDps(getAverageDps)"
						></SimpleOneLineCard>
						<SimpleOneLineCard
							title="Deaths:"
							:line="getAllDeaths"
						></SimpleOneLineCard>
						<SimpleOneLineCard
							title="Floortime:"
							:line="formatStringAsTimeSpan(getDeathTime)"
						></SimpleOneLineCard>
					</v-row>
					<v-row no-gutters dense>
						<DetailGraphsTabs
							:fightDuration="runData.fightDuration"
							:members="runData.members"
						></DetailGraphsTabs>
					</v-row>
					<v-row no-gutters dense>
						<PlayersInfoPanel
							:abnormalsData="abnormalsData"
							:skillData="skillsData"
							:members="runData.members"
						></PlayersInfoPanel>
					</v-row>
				</div>
			</v-col>
		</v-row>
	</v-container>
</template>

<script>
import BossEnrageCard from "@/components/DetailGraphs/EnrageCard.vue";
import BossDebuffsCard from "@/components/DetailGraphs/BossDebuffsCard.vue";
import IndeterminatedTopProgressBar from "@/components/Shared/IndeterminatedTopProgressBar.vue";
import PlayersInfoPanel from "@/components/Details/PlayersInfoPanel.vue";
import DetailGraphsTabs from "@/components/Details/DetailGraphsTabs.vue";
import RegisteredDamageCard from "@/components/DetailGraphs/RegisteredDamageCard.vue";

import SimpleMultilineCard from "@/components/Shared/SimpleMultilineCard.vue";
import SimpleDateTimeTextCard from "@/components/Shared/SimpleMultilineDateCard.vue";
import SimpleOneLineCard from "@/components/Shared/SimpleOneLineCard.vue";

export default {
	data: () => ({
		loadingSkillsData: true,
		loadingAbnormalData: true,
		abnormalsData: {},
		skillsData: {},
		runData: {
			huntingZoneId: "3104",
			bossId: "1000",
			debuffDetail: [
				[10153142, [[0, 99]]],
				[81120320, [[0, 98]]],
				[28090, [[0, 98]]],
				[15164, [[0, 72]]],
				[
					8888888,
					[
						[0, 43],
						[0, 43],
					],
				],
				[10153141, [[0, 19]]],
			],
			encounterUnixEpoch: 1617043261,
			fightDuration: "506",
			members: [
				{
					aggro: "2",
					buffDetail: [
						[99020020, [[0, 100]]],
						[5020003, [[0, 100]]],
						[100103, [[0, 100]]],
						[922, [[0, 100]]],
						[4830, [[0, 100]]],
						[999001021, [[0, 100]]],
						[806260, [[0, 88]]],
						[805102, [[0, 88]]],
						[801503, [[0, 87]]],
						[4020, [[0, 52]]],
						[30000024, [[0, 50]]],
						[
							31040004,
							[
								[0, 49],
								[1, 38],
								[2, 10],
							],
						],
						[4030, [[0, 46]]],
						[
							88120120,
							[
								[0, 46],
								[24, 38],
							],
						],
						[805713, [[0, 39]]],
						[100801, [[0, 33]]],
						[104120, [[0, 25]]],
						[805803, [[0, 23]]],
						[806022, [[0, 19]]],
						[21111, [[0, 17]]],
						[30000022, [[0, 17]]],
						[103130, [[0, 13]]],
						[28130, [[0, 11]]],
						[103104, [[0, 11]]],
						[999001052, [[0, 11]]],
						[21010, [[0, 11]]],
						[806021, [[0, 10]]],
						[6001, [[0, 9]]],
						[805700, [[0, 9]]],
						[806023, [[0, 8]]],
						[60032, [[0, 6]]],
						[88728206, [[0, 6]]],
						[800304, [[0, 3]]],
						[805712, [[0, 3]]],
						[21070, [[0, 2]]],
						[32040003, [[0, 2]]],
						[88116100, [[0, 2]]],
						[8888889, [[0, 2]]],
						[60950514, [[0, 1]]],
						[81010101, [[0, 1]]],
					],
					guild: "Digital",
					playerAverageCritRate: "80",
					playerClass: "Warrior",
					playerDeathDuration: "3",
					playerDeaths: "2",
					playerDps: "18718537",
					playerId: 2039752,
					playerName: "Slynna",
					playerServer: "Kaia",
					playerServerId: 42,
					playerTotalDamage: "9475111271",
					playerTotalDamagePercentage: "37",
					skillLog: [
						{
							skillAverageCrit: "31594326",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "27",
							skillHighestCrit: "59190790",
							skillHits: "83",
							skillCasts: "68",
							skillId: "380130",
							skillLowestCrit: "3192437",
							skillTotalDamage: "2622329104",
							skillTotalCritDamage: "2622329104",
						},
						{
							skillAverageCrit: "39401150",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "19",
							skillHighestCrit: "69860641",
							skillHits: "47",
							skillCasts: "35",
							skillId: "410131",
							skillLowestCrit: "4443254",
							skillTotalDamage: "1851854058",
							skillTotalCritDamage: "1851854058",
						},
						{
							skillAverageCrit: "3075907",
							skillAverageWhite: "1352799",
							skillCritRate: "92",
							skillDamagePercent: "17",
							skillHighestCrit: "10717694",
							skillHits: "570",
							skillCasts: "159",
							skillId: "290930",
							skillLowestCrit: "38813",
							skillTotalDamage: "1684342891",
							skillTotalCritDamage: "1630230893",
						},
						{
							skillAverageCrit: "2545249",
							skillAverageWhite: "1011206",
							skillCritRate: "84",
							skillDamagePercent: "12",
							skillHighestCrit: "8580429",
							skillHits: "499",
							skillCasts: "202",
							skillId: "400111",
							skillLowestCrit: "181053",
							skillTotalDamage: "1151958159",
							skillTotalCritDamage: "1074095283",
						},
						{
							skillAverageCrit: "1033187",
							skillAverageWhite: "490621",
							skillCritRate: "88",
							skillDamagePercent: "10",
							skillHighestCrit: "3488725",
							skillHits: "1039",
							skillCasts: "87",
							skillId: "40930",
							skillLowestCrit: "16252",
							skillTotalDamage: "1006745925",
							skillTotalCritDamage: "946399492",
						},
						{
							skillAverageCrit: "6895677",
							skillAverageWhite: "2863027",
							skillCritRate: "55",
							skillDamagePercent: "5",
							skillHighestCrit: "12078075",
							skillHits: "94",
							skillCasts: "77",
							skillId: "181101",
							skillLowestCrit: "624395",
							skillTotalDamage: "478822364",
							skillTotalCritDamage: "358575210",
						},
						{
							skillAverageCrit: "8363622",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "3",
							skillHighestCrit: "65894772",
							skillHits: "36",
							skillCasts: "4",
							skillId: "420130",
							skillLowestCrit: "190427",
							skillTotalDamage: "301090392",
							skillTotalCritDamage: "301090392",
						},
						{
							skillAverageCrit: "827586",
							skillAverageWhite: "289059",
							skillCritRate: "57",
							skillDamagePercent: "1",
							skillHighestCrit: "1304437",
							skillHits: "220",
							skillCasts: "16",
							skillId: "281030",
							skillLowestCrit: "86173",
							skillTotalDamage: "131985984",
							skillTotalCritDamage: "105103472",
						},
						{
							skillAverageCrit: "621847",
							skillAverageWhite: "265956",
							skillCritRate: "52",
							skillDamagePercent: "1",
							skillHighestCrit: "1469743",
							skillHits: "232",
							skillCasts: "35",
							skillId: "410100",
							skillLowestCrit: "59089",
							skillTotalDamage: "105120618",
							skillTotalCritDamage: "75865369",
						},
						{
							skillAverageCrit: "2113133",
							skillAverageWhite: "749572",
							skillCritRate: "28",
							skillDamagePercent: "0",
							skillHighestCrit: "3461081",
							skillHits: "50",
							skillCasts: "78",
							skillId: "161001",
							skillLowestCrit: "229398",
							skillTotalDamage: "56568467",
							skillTotalCritDamage: "29583873",
						},
						{
							skillAverageCrit: "1156353",
							skillAverageWhite: "452164",
							skillCritRate: "40",
							skillDamagePercent: "0",
							skillHighestCrit: "2726965",
							skillHits: "67",
							skillCasts: "35",
							skillId: "191100",
							skillLowestCrit: "84865",
							skillTotalDamage: "49308109",
							skillTotalCritDamage: "31221537",
						},
						{
							skillAverageCrit: "1378164",
							skillAverageWhite: "455656",
							skillCritRate: "33",
							skillDamagePercent: "0",
							skillHighestCrit: "2248583",
							skillHits: "36",
							skillCasts: "28",
							skillId: "111100",
							skillLowestCrit: "149829",
							skillTotalDamage: "27473719",
							skillTotalCritDamage: "16537974",
						},
						{
							skillAverageCrit: "2152238",
							skillAverageWhite: "910472",
							skillCritRate: "20",
							skillDamagePercent: "0",
							skillHighestCrit: "2152238",
							skillHits: "5",
							skillCasts: "8",
							skillId: "100700",
							skillLowestCrit: "2152238",
							skillTotalDamage: "5794127",
							skillTotalCritDamage: "2152238",
						},
						{
							skillAverageCrit: "1079775",
							skillAverageWhite: "318789",
							skillCritRate: "33",
							skillDamagePercent: "0",
							skillHighestCrit: "1079775",
							skillHits: "3",
							skillCasts: "3",
							skillId: "220200",
							skillLowestCrit: "1079775",
							skillTotalDamage: "1717354",
							skillTotalCritDamage: "1079775",
						},
						{
							skillCasts: "25",
							skillId: "20100",
						},
						{
							skillCasts: "7",
							skillId: "200200",
						},
					],
				},
				{
					aggro: "91",
					buffDetail: [
						[99020020, [[0, 100]]],
						[5020003, [[0, 100]]],
						[922, [[0, 100]]],
						[999001021, [[0, 100]]],
						[4030, [[0, 100]]],
						[8000122, [[0, 100]]],
						[4953, [[0, 100]]],
						[70233, [[0, 100]]],
						[806260, [[0, 100]]],
						[805102, [[0, 100]]],
						[31100, [[0, 99]]],
						[10153040, [[0, 99]]],
						[801503, [[0, 93]]],
						[10153000, [[0, 79]]],
						[
							10153510,
							[
								[0, 60],
								[5, 22],
								[6, 10],
								[7, 11],
								[8, 4],
								[9, 2],
								[10, 2],
								[11, 2],
								[12, 2],
								[13, 1],
							],
						],
						[31110, [[0, 49]]],
						[805713, [[0, 39]]],
						[
							31040004,
							[
								[0, 35],
								[1, 32],
								[2, 2],
							],
						],
						[10153150, [[0, 33]]],
						[10153050, [[0, 25]]],
						[805803, [[0, 23]]],
						[806022, [[0, 19]]],
						[88728206, [[0, 12]]],
						[806023, [[0, 12]]],
						[28130, [[0, 11]]],
						[800304, [[0, 9]]],
						[6001, [[0, 9]]],
						[30000016, [[0, 8]]],
						[805700, [[0, 8]]],
						[30000015, [[0, 8]]],
						[
							10153210,
							[
								[0, 8],
								[1, 1],
								[2, 1],
								[5, 3],
							],
						],
						[999001052, [[0, 7]]],
						[60032, [[0, 7]]],
						[806021, [[0, 5]]],
						[88722160, [[0, 4]]],
						[805712, [[0, 3]]],
						[31040001, [[0, 2]]],
						[32040003, [[0, 2]]],
					],
					guild: "Milky Tea",
					playerAverageCritRate: "54",
					playerClass: "Brawler",
					playerDeathDuration: "0",
					playerDeaths: "0",
					playerDps: "12411789",
					playerId: 8738376,
					playerName: "Ariana.Ana",
					playerServer: "Velik",
					playerServerId: 43,
					playerTotalDamage: "6282706736",
					playerTotalDamagePercentage: "24",
					skillLog: [
						{
							skillAverageCrit: "14970451",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "27",
							skillHighestCrit: "24780666",
							skillHits: "117",
							skillCasts: "92",
							skillId: "60966",
							skillLowestCrit: "8620902",
							skillTotalDamage: "1751542851",
							skillTotalCritDamage: "1751542851",
						},
						{
							skillAverageCrit: "3003982",
							skillAverageWhite: "1062212",
							skillCritRate: "36",
							skillDamagePercent: "18",
							skillHighestCrit: "7986338",
							skillHits: "661",
							skillCasts: "90",
							skillId: "91030",
							skillLowestCrit: "1541727",
							skillTotalDamage: "1173972496",
							skillTotalCritDamage: "729967665",
						},
						{
							skillAverageCrit: "11801690",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "17",
							skillHighestCrit: "26895044",
							skillHits: "91",
							skillCasts: "42",
							skillId: "240130",
							skillLowestCrit: "2897947",
							skillTotalDamage: "1073953797",
							skillTotalCritDamage: "1073953797",
						},
						{
							skillAverageCrit: "5429143",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "10",
							skillHighestCrit: "9485425",
							skillHits: "123",
							skillCasts: "61",
							skillId: "100800",
							skillLowestCrit: "2765157",
							skillTotalDamage: "667784617",
							skillTotalCritDamage: "667784617",
						},
						{
							skillAverageCrit: "3186038",
							skillAverageWhite: "839618",
							skillCritRate: "64",
							skillDamagePercent: "9",
							skillHighestCrit: "9393075",
							skillHits: "261",
							skillCasts: "65",
							skillId: "81030",
							skillLowestCrit: "1317420",
							skillTotalDamage: "615685321",
							skillTotalCritDamage: "538440446",
						},
						{
							skillAverageCrit: "5455090",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "4",
							skillHighestCrit: "10399584",
							skillHits: "56",
							skillCasts: "25",
							skillId: "260102",
							skillLowestCrit: "4275731",
							skillTotalDamage: "305485072",
							skillTotalCritDamage: "305485072",
						},
						{
							skillAverageCrit: "3546117",
							skillAverageWhite: "1639033",
							skillCritRate: "27",
							skillDamagePercent: "3",
							skillHighestCrit: "5806938",
							skillHits: "97",
							skillCasts: "85",
							skillId: "71130",
							skillLowestCrit: "1880022",
							skillTotalDamage: "210477494",
							skillTotalCritDamage: "95745179",
						},
						{
							skillAverageCrit: "5597922",
							skillAverageWhite: "3012068",
							skillCritRate: "35",
							skillDamagePercent: "3",
							skillHighestCrit: "8650416",
							skillHits: "48",
							skillCasts: "40",
							skillId: "220130",
							skillLowestCrit: "3061047",
							skillTotalDamage: "188538791",
							skillTotalCritDamage: "95164675",
						},
						{
							skillAverageCrit: "5811175",
							skillAverageWhite: "1418309",
							skillCritRate: "19",
							skillDamagePercent: "2",
							skillHighestCrit: "15287633",
							skillHits: "82",
							skillCasts: "12",
							skillId: "171010",
							skillLowestCrit: "2314961",
							skillTotalDamage: "186587243",
							skillTotalCritDamage: "92978808",
						},
						{
							skillAverageCrit: "4698018",
							skillAverageWhite: "1789090",
							skillCritRate: "17",
							skillDamagePercent: "1",
							skillHighestCrit: "10044296",
							skillHits: "35",
							skillCasts: "11",
							skillId: "41130",
							skillLowestCrit: "2395542",
							skillTotalDamage: "80071736",
							skillTotalCritDamage: "28188110",
						},
						{
							skillAverageCrit: "2881998",
							skillAverageWhite: "1063790",
							skillCritRate: "10",
							skillDamagePercent: "0",
							skillHighestCrit: "2881998",
							skillHits: "10",
							skillCasts: "21",
							skillId: "21201",
							skillLowestCrit: "2881998",
							skillTotalDamage: "12456108",
							skillTotalCritDamage: "2881998",
						},
						{
							skillAverageCrit: "11185992",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "0",
							skillHighestCrit: "11185992",
							skillHits: "1",
							skillId: "30201",
							skillLowestCrit: "11185992",
							skillTotalDamage: "11185992",
							skillTotalCritDamage: "11185992",
						},
						{
							skillAverageCrit: "457251",
							skillAverageWhite: "223161",
							skillCritRate: "29",
							skillDamagePercent: "0",
							skillHighestCrit: "701318",
							skillHits: "17",
							skillCasts: "38",
							skillId: "11230",
							skillLowestCrit: "239760",
							skillTotalDamage: "4964200",
							skillTotalCritDamage: "2286259",
						},
						{
							skillAverageCrit: "1018",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "0",
							skillHighestCrit: "1018",
							skillHits: "1",
							skillCasts: "1",
							skillId: "180130",
							skillLowestCrit: "1018",
							skillTotalDamage: "1018",
							skillTotalCritDamage: "1018",
						},
						{
							skillCasts: "34",
							skillId: "400100",
						},
						{
							skillCasts: "4",
							skillId: "50800",
						},
						{
							skillCasts: "2",
							skillId: "140130",
						},
						{
							skillCasts: "1",
							skillId: "1101104",
						},
					],
				},
				{
					aggro: "0",
					buffDetail: [
						[99020020, [[0, 100]]],
						[5020003, [[0, 100]]],
						[30, [[0, 100]]],
						[999001021, [[0, 100]]],
						[10152113, [[0, 100]]],
						[4020, [[0, 99]]],
						[806260, [[0, 98]]],
						[805102, [[0, 98]]],
						[10152270, [[0, 98]]],
						[10152100, [[0, 97]]],
						[801503, [[0, 93]]],
						[922, [[0, 93]]],
						[4830, [[0, 85]]],
						[
							89105120,
							[
								[0, 79],
								[1, 2],
								[2, 1],
								[3, 5],
								[4, 2],
								[5, 10],
								[6, 8],
								[7, 10],
								[8, 1],
								[9, 4],
								[10, 3],
								[12, 4],
								[13, 4],
								[15, 1],
								[16, 4],
								[18, 6],
								[19, 1],
								[20, 4],
							],
						],
						[4951, [[0, 68]]],
						[30000024, [[0, 50]]],
						[
							31040004,
							[
								[0, 49],
								[1, 42],
								[2, 1],
								[3, 5],
							],
						],
						[30021, [[0, 45]]],
						[30100, [[0, 43]]],
						[10152340, [[0, 35]]],
						[805713, [[0, 35]]],
						[805803, [[0, 23]]],
						[10152501, [[0, 23]]],
						[10152120, [[0, 18]]],
						[10152503, [[0, 18]]],
						[30000023, [[0, 17]]],
						[88728206, [[0, 14]]],
						[
							10152500,
							[
								[0, 13],
								[1, 1],
								[2, 1],
								[6, 1],
								[11, 1],
								[13, 1],
							],
						],
						[
							10152050,
							[
								[0, 13],
								[1, 1],
								[5, 10],
							],
						],
						[10152353, [[0, 13]]],
						[806023, [[0, 12]]],
						[28130, [[0, 11]]],
						[999001052, [[0, 11]]],
						[805700, [[0, 10]]],
						[806022, [[0, 9]]],
						[81112015, [[0, 8]]],
						[60032, [[0, 7]]],
						[10152351, [[0, 7]]],
						[81123001, [[0, 7]]],
						[800304, [[0, 7]]],
						[30050, [[0, 6]]],
						[10152040, [[0, 6]]],
						[
							10152502,
							[
								[0, 6],
								[2, 2],
								[3, 1],
							],
						],
						[8888889, [[0, 6]]],
						[806021, [[0, 5]]],
						[10152302, [[0, 4]]],
						[10152221, [[0, 4]]],
						[805712, [[0, 3]]],
						[10152300, [[0, 3]]],
						[88722160, [[0, 2]]],
						[32040003, [[0, 2]]],
					],
					guild: "Turn Up",
					playerAverageCritRate: "70",
					playerClass: "Gunner",
					playerDeathDuration: "2",
					playerDeaths: "1",
					playerDps: "10999338",
					playerId: 31223,
					playerName: "Astrid",
					playerServer: "Kaia",
					playerServerId: 42,
					playerTotalDamage: "5567740025",
					playerTotalDamagePercentage: "22",
					skillLog: [
						{
							skillAverageCrit: "2742570",
							skillAverageWhite: "981859",
							skillCritRate: "87",
							skillDamagePercent: "16",
							skillHighestCrit: "4038749",
							skillHits: "361",
							skillId: "93133",
							skillLowestCrit: "1587867",
							skillTotalDamage: "910835990",
							skillTotalCritDamage: "866652334",
						},
						{
							skillAverageCrit: "9097165",
							skillAverageWhite: "1577954",
							skillCritRate: "63",
							skillDamagePercent: "15",
							skillHighestCrit: "16899218",
							skillHits: "139",
							skillId: "430151",
							skillLowestCrit: "1059271",
							skillTotalDamage: "881026234",
							skillTotalCritDamage: "800550540",
						},
						{
							skillAverageCrit: "11403132",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "9",
							skillHighestCrit: "15465042",
							skillHits: "44",
							skillId: "71121",
							skillLowestCrit: "8270334",
							skillTotalDamage: "501737843",
							skillTotalCritDamage: "501737843",
						},
						{
							skillAverageCrit: "2281673",
							skillAverageWhite: "823752",
							skillCritRate: "97",
							skillDamagePercent: "7",
							skillHighestCrit: "2995155",
							skillHits: "191",
							skillId: "51016",
							skillLowestCrit: "1873012",
							skillTotalDamage: "428509958",
							skillTotalCritDamage: "424391195",
						},
						{
							skillAverageCrit: "75404776",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "6",
							skillHighestCrit: "99831141",
							skillHits: "5",
							skillCasts: "5",
							skillId: "440101",
							skillLowestCrit: "60138714",
							skillTotalDamage: "377023880",
							skillTotalCritDamage: "377023880",
						},
						{
							skillAverageCrit: "1570762",
							skillAverageWhite: "588279",
							skillCritRate: "44",
							skillDamagePercent: "6",
							skillHighestCrit: "4534222",
							skillHits: "363",
							skillCasts: "73",
							skillId: "31102",
							skillLowestCrit: "354222",
							skillTotalDamage: "372707718",
							skillTotalCritDamage: "254463556",
						},
						{
							skillAverageCrit: "1550307",
							skillAverageWhite: "556581",
							skillCritRate: "86",
							skillDamagePercent: "6",
							skillHighestCrit: "4710158",
							skillHits: "253",
							skillId: "520120",
							skillLowestCrit: "999995",
							skillTotalDamage: "359434829",
							skillTotalCritDamage: "341067638",
						},
						{
							skillAverageCrit: "2319481",
							skillAverageWhite: "684831",
							skillCritRate: "45",
							skillDamagePercent: "4",
							skillHighestCrit: "3364959",
							skillHits: "175",
							skillId: "420120",
							skillLowestCrit: "1005642",
							skillTotalDamage: "250617576",
							skillTotalCritDamage: "185558539",
						},
						{
							skillAverageCrit: "2334451",
							skillAverageWhite: "685596",
							skillCritRate: "99",
							skillDamagePercent: "4",
							skillHighestCrit: "3242256",
							skillHits: "106",
							skillId: "51026",
							skillLowestCrit: "1808404",
							skillTotalDamage: "245802982",
							skillTotalCritDamage: "245117386",
						},
						{
							skillAverageCrit: "1751141",
							skillAverageWhite: "649596",
							skillCritRate: "48",
							skillDamagePercent: "4",
							skillHighestCrit: "2368831",
							skillHits: "199",
							skillId: "120720",
							skillLowestCrit: "1192029",
							skillTotalDamage: "235018107",
							skillTotalCritDamage: "168109623",
						},
						{
							skillAverageCrit: "3821667",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "4",
							skillHighestCrit: "5232366",
							skillHits: "60",
							skillId: "470170",
							skillLowestCrit: "2879061",
							skillTotalDamage: "229300079",
							skillTotalCritDamage: "229300079",
						},
						{
							skillAverageCrit: "4478596",
							skillAverageWhite: "1759408",
							skillCritRate: "65",
							skillDamagePercent: "3",
							skillHighestCrit: "5746313",
							skillHits: "55",
							skillId: "20620",
							skillLowestCrit: "3010948",
							skillTotalDamage: "194658224",
							skillTotalCritDamage: "161229459",
						},
						{
							skillAverageCrit: "464426",
							skillAverageWhite: "176274",
							skillCritRate: "90",
							skillDamagePercent: "2",
							skillHighestCrit: "2433632",
							skillHits: "359",
							skillId: "51021",
							skillLowestCrit: "98734",
							skillTotalDamage: "156932032",
							skillTotalCritDamage: "150938708",
						},
						{
							skillAverageCrit: "7514038",
							skillAverageWhite: "2777644",
							skillCritRate: "44",
							skillDamagePercent: "2",
							skillHighestCrit: "9271071",
							skillHits: "25",
							skillId: "61122",
							skillLowestCrit: "5874391",
							skillTotalDamage: "121541443",
							skillTotalCritDamage: "82654425",
						},
						{
							skillAverageCrit: "1390628",
							skillAverageWhite: "224117",
							skillCritRate: "58",
							skillDamagePercent: "1",
							skillHighestCrit: "2325156",
							skillHits: "109",
							skillId: "51011",
							skillLowestCrit: "70843",
							skillTotalDamage: "99085498",
							skillTotalCritDamage: "89000205",
						},
						{
							skillAverageCrit: "1289465",
							skillAverageWhite: "459697",
							skillCritRate: "32",
							skillDamagePercent: "1",
							skillHighestCrit: "1642235",
							skillHits: "122",
							skillId: "11220",
							skillLowestCrit: "928822",
							skillTotalDamage: "89273839",
							skillTotalCritDamage: "51578615",
						},
						{
							skillAverageCrit: "5235294",
							skillAverageWhite: "1977637",
							skillCritRate: "61",
							skillDamagePercent: "0",
							skillHighestCrit: "6994730",
							skillHits: "13",
							skillId: "510120",
							skillLowestCrit: "3962005",
							skillTotalDamage: "51770541",
							skillTotalCritDamage: "41882352",
						},
						{
							skillAverageCrit: "1234220",
							skillAverageWhite: "465129",
							skillCritRate: "33",
							skillDamagePercent: "0",
							skillHighestCrit: "1459314",
							skillHits: "42",
							skillId: "71120",
							skillLowestCrit: "1092694",
							skillTotalDamage: "30302711",
							skillTotalCritDamage: "17279081",
						},
						{
							skillAverageCrit: "1320321",
							skillAverageWhite: "483059",
							skillCritRate: "17",
							skillDamagePercent: "0",
							skillHighestCrit: "1600159",
							skillHits: "41",
							skillId: "61120",
							skillLowestCrit: "861232",
							skillTotalDamage: "25666284",
							skillTotalCritDamage: "9242252",
						},
						{
							skillAverageCrit: "2291851",
							skillAverageWhite: "851790",
							skillCritRate: "33",
							skillDamagePercent: "0",
							skillHighestCrit: "2291851",
							skillHits: "3",
							skillId: "110830",
							skillLowestCrit: "2291851",
							skillTotalDamage: "3995431",
							skillTotalCritDamage: "2291851",
						},
						{
							skillAverageCrit: "0",
							skillAverageWhite: "898950",
							skillCritRate: "0",
							skillDamagePercent: "0",
							skillHighestCrit: "0",
							skillHits: "1",
							skillCasts: "2",
							skillId: "110831",
							skillLowestCrit: "0",
							skillTotalDamage: "898950",
							skillTotalCritDamage: "0",
						},
						{
							skillAverageCrit: "853142",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "0",
							skillHighestCrit: "853142",
							skillHits: "1",
							skillCasts: "1",
							skillId: "40802",
							skillLowestCrit: "853142",
							skillTotalDamage: "853142",
							skillTotalCritDamage: "853142",
						},
						{
							skillAverageCrit: "0",
							skillAverageWhite: "746734",
							skillCritRate: "0",
							skillDamagePercent: "0",
							skillHighestCrit: "0",
							skillHits: "1",
							skillId: "100924",
							skillLowestCrit: "0",
							skillTotalDamage: "746734",
							skillTotalCritDamage: "0",
						},
						{
							skillCasts: "320",
							skillId: "51010",
						},
						{
							skillCasts: "171",
							skillId: "51020",
						},
						{
							skillCasts: "123",
							skillId: "11201",
						},
						{
							skillCasts: "119",
							skillId: "93112",
						},
						{
							skillCasts: "88",
							skillId: "71102",
						},
						{
							skillCasts: "81",
							skillId: "430103",
						},
						{
							skillCasts: "61",
							skillId: "420101",
						},
						{
							skillCasts: "46",
							skillId: "400102",
						},
						{
							skillCasts: "43",
							skillId: "400101",
						},
						{
							skillCasts: "42",
							skillId: "61101",
						},
						{
							skillCasts: "14",
							skillId: "20600",
						},
						{
							skillCasts: "13",
							skillId: "1081008",
						},
						{
							skillCasts: "7",
							skillId: "410130",
						},
						{
							skillCasts: "6",
							skillId: "110801",
						},
						{
							skillCasts: "6",
							skillId: "470101",
						},
						{
							skillCasts: "3",
							skillId: "151102",
						},
						{
							skillCasts: "2",
							skillId: "100930",
						},
						{
							skillCasts: "1",
							skillId: "180701",
						},
					],
				},
				{
					aggro: "0",
					buffDetail: [
						[81000016, [[0, 100]]],
						[99020020, [[0, 100]]],
						[4610, [[0, 100]]],
						[999001021, [[0, 100]]],
						[30, [[0, 100]]],
						[4830, [[0, 100]]],
						[4024, [[0, 97]]],
						[806260, [[0, 92]]],
						[805102, [[0, 92]]],
						[801503, [[0, 87]]],
						[25021, [[0, 85]]],
						[13054, [[0, 54]]],
						[500602, [[0, 50]]],
						[81123104, [[0, 46]]],
						[501800, [[0, 44]]],
						[805713, [[0, 38]]],
						[
							31040004,
							[
								[0, 29],
								[1, 19],
								[2, 7],
								[3, 2],
							],
						],
						[502040, [[0, 27]]],
						[
							502051,
							[
								[0, 27],
								[1, 13],
								[2, 14],
							],
						],
						[502070, [[0, 21]]],
						[805803, [[0, 20]]],
						[503061, [[0, 19]]],
						[4951, [[0, 19]]],
						[502071, [[0, 15]]],
						[502020, [[0, 15]]],
						[502072, [[0, 14]]],
						[502030, [[0, 13]]],
						[806023, [[0, 12]]],
						[28130, [[0, 11]]],
						[999001044, [[0, 10]]],
						[805700, [[0, 8]]],
						[502050, [[0, 8]]],
						[60032, [[0, 7]]],
						[88728206, [[0, 7]]],
						[6001, [[0, 7]]],
						[806022, [[0, 7]]],
						[800304, [[0, 6]]],
						[502001, [[0, 4]]],
						[805712, [[0, 3]]],
						[501600, [[0, 3]]],
						[806021, [[0, 2]]],
						[8888889, [[0, 2]]],
						[32040003, [[0, 2]]],
						[25140, [[0, 2]]],
						[60950514, [[0, 1]]],
						[81010101, [[0, 1]]],
					],
					guild: "Death To Our Enemies",
					playerAverageCritRate: "45",
					playerClass: "Sorcerer",
					playerDeathDuration: "14",
					playerDeaths: "2",
					playerDps: "6352922",
					playerId: 8555643,
					playerName: "Cstscs",
					playerServer: "Velik",
					playerServerId: 43,
					playerTotalDamage: "3215777179",
					playerTotalDamagePercentage: "12",
					skillLog: [
						{
							skillAverageCrit: "9930913",
							skillAverageWhite: "2817601",
							skillCritRate: "65",
							skillDamagePercent: "18",
							skillHighestCrit: "21995663",
							skillHits: "81",
							skillId: "320120",
							skillLowestCrit: "2166663",
							skillTotalDamage: "605231238",
							skillTotalCritDamage: "526338394",
						},
						{
							skillAverageCrit: "3033182",
							skillAverageWhite: "1119536",
							skillCritRate: "30",
							skillDamagePercent: "10",
							skillHighestCrit: "4778902",
							skillHits: "200",
							skillId: "350120",
							skillLowestCrit: "1628265",
							skillTotalDamage: "340639680",
							skillTotalCritDamage: "185024110",
						},
						{
							skillAverageCrit: "28703911",
							skillAverageWhite: "9555525",
							skillCritRate: "84",
							skillDamagePercent: "10",
							skillHighestCrit: "37565788",
							skillHits: "13",
							skillCasts: "13",
							skillId: "360600",
							skillLowestCrit: "23003622",
							skillTotalDamage: "334854073",
							skillTotalCritDamage: "315743023",
						},
						{
							skillAverageCrit: "12120301",
							skillAverageWhite: "4828246",
							skillCritRate: "45",
							skillDamagePercent: "9",
							skillHighestCrit: "16280106",
							skillHits: "37",
							skillCasts: "37",
							skillId: "300900",
							skillLowestCrit: "9949403",
							skillTotalDamage: "302610056",
							skillTotalCritDamage: "206045132",
						},
						{
							skillAverageCrit: "11255441",
							skillAverageWhite: "3725194",
							skillCritRate: "67",
							skillDamagePercent: "9",
							skillHighestCrit: "17356946",
							skillHits: "34",
							skillId: "120920",
							skillLowestCrit: "7741669",
							skillTotalDamage: "299852288",
							skillTotalCritDamage: "258875146",
						},
						{
							skillAverageCrit: "8099387",
							skillAverageWhite: "2833255",
							skillCritRate: "41",
							skillDamagePercent: "8",
							skillHighestCrit: "10929240",
							skillHits: "55",
							skillId: "330125",
							skillLowestCrit: "2241834",
							skillTotalDamage: "276950079",
							skillTotalCritDamage: "186285916",
						},
						{
							skillAverageCrit: "1083325",
							skillAverageWhite: "393599",
							skillCritRate: "41",
							skillDamagePercent: "7",
							skillHighestCrit: "1715265",
							skillHits: "375",
							skillId: "270920",
							skillLowestCrit: "490318",
							skillTotalDamage: "254507339",
							skillTotalCritDamage: "167915398",
						},
						{
							skillAverageCrit: "19596272",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "7",
							skillHighestCrit: "60589644",
							skillHits: "12",
							skillId: "390120",
							skillLowestCrit: "6601943",
							skillTotalDamage: "235155269",
							skillTotalCritDamage: "235155269",
						},
						{
							skillAverageCrit: "4671995",
							skillAverageWhite: "1604956",
							skillCritRate: "64",
							skillDamagePercent: "7",
							skillHighestCrit: "9800630",
							skillHits: "64",
							skillId: "111140",
							skillLowestCrit: "2782584",
							skillTotalDamage: "228465788",
							skillTotalCritDamage: "191551800",
						},
						{
							skillAverageCrit: "21630264",
							skillAverageWhite: "8833931",
							skillCritRate: "57",
							skillDamagePercent: "3",
							skillHighestCrit: "26554141",
							skillHits: "7",
							skillId: "360480",
							skillLowestCrit: "19044982",
							skillTotalDamage: "113022852",
							skillTotalCritDamage: "86521058",
						},
						{
							skillAverageCrit: "22362212",
							skillAverageWhite: "9439343",
							skillCritRate: "60",
							skillDamagePercent: "2",
							skillHighestCrit: "24579509",
							skillHits: "5",
							skillCasts: "7",
							skillId: "360300",
							skillLowestCrit: "18003589",
							skillTotalDamage: "85965323",
							skillTotalCritDamage: "67086637",
						},
						{
							skillAverageCrit: "12196958",
							skillAverageWhite: "4181716",
							skillCritRate: "50",
							skillDamagePercent: "2",
							skillHighestCrit: "13318116",
							skillHits: "10",
							skillId: "360222",
							skillLowestCrit: "9544439",
							skillTotalDamage: "81893373",
							skillTotalCritDamage: "60984790",
						},
						{
							skillAverageCrit: "2974721",
							skillAverageWhite: "1275112",
							skillCritRate: "29",
							skillDamagePercent: "1",
							skillHighestCrit: "4292910",
							skillHits: "31",
							skillId: "21020",
							skillLowestCrit: "1009893",
							skillTotalDamage: "54824962",
							skillTotalCritDamage: "26772489",
						},
						{
							skillAverageCrit: "1388126",
							skillAverageWhite: "416733",
							skillCritRate: "50",
							skillDamagePercent: "0",
							skillHighestCrit: "1388126",
							skillHits: "2",
							skillCasts: "2",
							skillId: "180600",
							skillLowestCrit: "1388126",
							skillTotalDamage: "1804859",
							skillTotalCritDamage: "1388126",
						},
						{
							skillCasts: "67",
							skillId: "111100",
						},
						{
							skillCasts: "48",
							skillId: "41200",
						},
						{
							skillCasts: "34",
							skillId: "120900",
						},
						{
							skillCasts: "32",
							skillId: "320150",
						},
						{
							skillCasts: "28",
							skillId: "21000",
						},
						{
							skillCasts: "25",
							skillId: "270900",
						},
						{
							skillCasts: "20",
							skillId: "70100",
						},
						{
							skillCasts: "12",
							skillId: "320100",
						},
						{
							skillCasts: "9",
							skillId: "310120",
						},
						{
							skillCasts: "8",
							skillId: "360400",
						},
						{
							skillCasts: "6",
							skillId: "100300",
						},
						{
							skillCasts: "5",
							skillId: "260100",
						},
						{
							skillCasts: "5",
							skillId: "340230",
						},
						{
							skillCasts: "5",
							skillId: "360200",
						},
						{
							skillCasts: "3",
							skillId: "390100",
						},
						{
							skillCasts: "2",
							skillId: "1080504",
						},
					],
				},
				{
					aggro: "4",
					buffDetail: [
						[28050, [[0, 100]]],
						[99020020, [[0, 100]]],
						[5020003, [[0, 100]]],
						[806260, [[0, 100]]],
						[805102, [[0, 100]]],
						[999001021, [[0, 100]]],
						[30, [[0, 100]]],
						[4951, [[0, 100]]],
						[4830, [[0, 100]]],
						[922, [[0, 100]]],
						[4021, [[0, 100]]],
						[801503, [[0, 93]]],
						[806103, [[0, 43]]],
						[805713, [[0, 39]]],
						[805800, [[0, 23]]],
						[81123015, [[0, 22]]],
						[
							31040004,
							[
								[0, 21],
								[1, 10],
								[2, 7],
								[3, 2],
							],
						],
						[30000021, [[0, 17]]],
						[30000020, [[0, 17]]],
						[800950, [[0, 14]]],
						[800304, [[0, 9]]],
						[805700, [[0, 9]]],
						[6001, [[0, 8]]],
						[60032, [[0, 7]]],
						[88728206, [[0, 6]]],
						[805712, [[0, 3]]],
						[31040001, [[0, 3]]],
						[88722160, [[0, 2]]],
						[32040003, [[0, 2]]],
						[15164, [[0, 2]]],
						[8888889, [[0, 1]]],
					],
					guild: "Turn Up",
					healCrit: "100",
					playerAverageCritRate: "72",
					playerClass: "Priest",
					playerDeathDuration: "0",
					playerDeaths: "0",
					playerDps: "1254463",
					playerId: 5487394,
					playerName: "Sawako",
					playerServer: "Kaia",
					playerServerId: 42,
					playerTotalDamage: "634995320",
					playerTotalDamagePercentage: "2",
					skillLog: [
						{
							skillAverageCrit: "4909415",
							skillAverageWhite: "1666766",
							skillCritRate: "98",
							skillDamagePercent: "56",
							skillHighestCrit: "8989931",
							skillHits: "74",
							skillId: "423123",
							skillLowestCrit: "2965956",
							skillTotalDamage: "360054097",
							skillTotalCritDamage: "358387331",
						},
						{
							skillAverageCrit: "3192394",
							skillAverageWhite: "1115905",
							skillCritRate: "87",
							skillDamagePercent: "18",
							skillHighestCrit: "5611243",
							skillHits: "41",
							skillId: "401012",
							skillLowestCrit: "2010986",
							skillTotalDamage: "120505745",
							skillTotalCritDamage: "114926219",
						},
						{
							skillAverageCrit: "975334",
							skillAverageWhite: "375643",
							skillCritRate: "65",
							skillDamagePercent: "18",
							skillHighestCrit: "1339308",
							skillHits: "156",
							skillCasts: "26",
							skillId: "161120",
							skillLowestCrit: "738305",
							skillTotalDamage: "119768835",
							skillTotalCritDamage: "99484075",
						},
						{
							skillAverageCrit: "438585",
							skillAverageWhite: "157579",
							skillCritRate: "58",
							skillDamagePercent: "3",
							skillHighestCrit: "702307",
							skillHits: "67",
							skillCasts: "68",
							skillId: "290900",
							skillLowestCrit: "301885",
							skillTotalDamage: "21517050",
							skillTotalCritDamage: "17104834",
						},
						{
							skillAverageCrit: "604187",
							skillAverageWhite: "238863",
							skillCritRate: "50",
							skillDamagePercent: "1",
							skillHighestCrit: "828739",
							skillHits: "28",
							skillId: "350410",
							skillLowestCrit: "446709",
							skillTotalDamage: "11802720",
							skillTotalCritDamage: "8458629",
						},
						{
							skillAverageCrit: "448957",
							skillAverageWhite: "0",
							skillCritRate: "100",
							skillDamagePercent: "0",
							skillHighestCrit: "501438",
							skillHits: "3",
							skillCasts: "3",
							skillId: "261000",
							skillLowestCrit: "406594",
							skillTotalDamage: "1346873",
							skillTotalCritDamage: "1346873",
						},
						{
							skillCasts: "74",
							skillId: "423120",
						},
						{
							skillCasts: "61",
							skillId: "193000",
						},
						{
							skillCasts: "57",
							skillId: "350400",
						},
						{
							skillCasts: "44",
							skillId: "280200",
						},
						{
							skillCasts: "41",
							skillId: "401010",
						},
						{
							skillCasts: "35",
							skillId: "370200",
						},
						{
							skillCasts: "19",
							skillId: "340200",
						},
						{
							skillCasts: "17",
							skillId: "380100",
						},
						{
							skillCasts: "11",
							skillId: "181200",
						},
						{
							skillCasts: "7",
							skillId: "50300",
						},
						{
							skillCasts: "6",
							skillId: "430100",
						},
						{
							skillCasts: "6",
							skillId: "20900",
						},
						{
							skillCasts: "5",
							skillId: "100100",
						},
						{
							skillCasts: "4",
							skillId: "220500",
						},
						{
							skillCasts: "2",
							skillId: "30700",
						},
						{
							skillCasts: "1",
							skillId: "1100704",
						},
					],
				},
			],
			meterName: "ShinraMeter",
			meterVersion: "2.84.80f7c88",
			partyDps: "49737051",
			uploader: "2",
			timestamp: 1617043261,
		},
	}),
	props: ["runId"],
	name: "DetailedRun",
	components: {
		BossEnrageCard,
		BossDebuffsCard,
		IndeterminatedTopProgressBar,
		PlayersInfoPanel,
		SimpleMultilineCard,
		DetailGraphsTabs,
		RegisteredDamageCard,
		SimpleDateTimeTextCard,
		SimpleOneLineCard,
	},
	watch: {
		"$vuetify.lang.current"() {
			this.loadDynamicAbnormalData();
			this.loadDynamicSkillData();
			//load abnormals icons file
			//this.$http.files.get(`/dps-parse/${this.$vuetify.lang.current}/abnormals-icons.json`).then(res => (this.abnormalsIconData = res));
			//load skills icons file
			//this.$http.files.get(`/dps-parse/${this.$vuetify.lang.current}/skills-icons.json`).then(res => (this.skillsIconData = res));
		},
	},
	created: function () {
		this.loadDynamicAbnormalData();
		this.loadDynamicSkillData();
	},
	methods: {
		loadDynamicAbnormalData() {
			this.$http.files
				.get(`dpsData/${this.$vuetify.lang.current}/abnormals.json`)
				.then((res) => {
					this.abnormalsData = res.data;
					this.loadingAbnormalData = false;
				});
		},
		loadDynamicSkillData() {
			this.$http.files
				.get(`dpsData/${this.$vuetify.lang.current}/skills.json`)
				.then((res) => {
					this.skillsData = res.data;
					this.loadingSkillsData = false;
				});
		},
		loadDRunDetails() {
			this.$http.api.get(`uploads/${this.runId}`).then((res) => {
				this.abnormalsData = res;
				this.loadingAbnormalData = false;
			});
		},
	},
	computed: {
		enrageData() {
			let item = this.runData.debuffDetail.find((x) => x[0] === 8888888);
			return item[1][0][1] || 0;
		},
		bossName() {
			return this.$vuetify.lang.t(
				`$vuetify.monsters.${this.runData.huntingZoneId}.monsters.${this.runData.bossId}.name`
			);
		},
		dungeonName() {
			return this.$vuetify.lang.t(
				`$vuetify.monsters.${this.runData.huntingZoneId}.name`
			);
		},
		loadingData() {
			return this.loadingSkillsData || this.loadingAbnormalData;
		},
		allDeaths() {
			const deaths = this.runData.members.map((x) => x.playerDeaths);
			const summ = deaths.reduce((a, b) => Number(a) + Number(b), 0);
			return summ;
		},
		getFormattedHours() {
			let date = new Date(this.formatSecsToTimestamp(this.runData.timestamp));

			return `${(date.getHours() + 1).toString().padStart(2, "0")}:${(
				date.getMinutes() + 1
			)
				.toString()
				.padStart(2, "0")}`;
		},
		getFormattedDate() {
			let date = new Date(this.formatSecsToTimestamp(this.runData.timestamp));

			return `${(date.getDay() + 1).toString().padStart(2, "0")}.${(
				date.getMonth() + 1
			)
				.toString()
				.padStart(2, "0")}.${date.getFullYear()}`;
		},
		getAverageDps() {
			return this.runData.partyDps / (this.runData.members.length || 1);
		},
		getAllDeaths() {
			let deaths = 0;
			this.runData.members.forEach((member) => {
				deaths += Number(member.playerDeaths);
			});

			return deaths;
		},
		getDeathTime() {
			let deathTime = 0;
			this.runData.members.forEach((member) => {
				deathTime += Number(member.playerDeathDuration);
			});

			return deathTime;
		},
	},
	mounted: function () {
		console.log("hi");
	},
};
</script>
